<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <title>Star Wars RPG Game</title>
</head>
<body>
    <h1 style="text-align:center">Star Wars RPG!</h1>
    <div style="width:500px">
    <div class="hero_selection" width= "100%"></div>
    <h3 >Your Character</h3>
    <div class="character"></div>
    <div width="500px">
        <h3>Enemies Available To Attack</h3>
        <div class="available_enemies" width="100%"></div>
        <h3>Fight Selection</h3>
        <button id="fight" enabled>Attack</button>
        <h3>Defender</h3>
        <div class="defender_hero"></div>
    </div>
    </div>
    <script>
        var starWars = {
            isSelectHero: false,
            isSelectDefender: false,
            defender_hp: 0,
            hero_hp: 0,
            game_over: false,
            heroes : [{
                name: "Obi-Wan Kenobi",
                health_points: 120,
                attack_power: 2,
                counter_attack_power: 25,
                src: "Test.jpg"
            },
            {
                name: "Luke Skywalker",
                health_points: 100,
                attack_power: 2,
                counter_attack_power: 10,
                src: "Test.jpg"
            },
            {
                name: "Darth Sidious",
                health_points: 150,
                attack_power: 2,
                counter_attack_power: 30,
                src: "Test.jpg"
            },
            {
                name: "Darth Maul",
                health_points: 180,
                attack_power: 2,
                counter_attack_power: 35,
                src:"Test.jpg"
            }],
            initiateGame: function () {
                var characters = $(".hero_selection");
                this.isSelectHero = false;
                this.isSelectDefender = false;
                //create a div for each hero
                this.heroes.forEach(function(hero){
                    var heroDiv = $("<div>");
                    var name = $("<span>");
                    var image = $("<img>");
                    var hp = $("<span>");
                    name.text(hero.name);
                    image.attr("src",hero.src);
                    hp.text("" + hero.health_points);
                    hp.addClass("hp")
                    heroDiv.addClass("hero");
                    heroDiv.attr("style","float:left;width:125px;height:125px");
                    heroDiv.attr("health_points",hero.health_points);
                    heroDiv.attr("attack_power",hero.attack_power);
                    heroDiv.attr("counter_attack_power",hero.counter_attack_power);
                    heroDiv.append(name);
                    heroDiv.append(image);
                    heroDiv.append(hp);
                    $(".hero_selection").append(heroDiv);
                }); 
                //add click events   
                $(".hero").click(function(){
                    if(starWars.isSelectHero == false){
                        starWars.hero_hp = $(this).attr("health_points");
                        starWars.isSelectHero = true;
                        $(".character").append($(this));
                        $(this).css("float","none");
                        $(this).addClass("selected_hero");
                        $(".available_enemies").append($(".hero_selection").children());
                        $(".available_enemies").children().removeClass("hero");
                        $(".available_enemies").children().addClass("enemy");
                        $(".available_enemies").children().last().css("float","none");
                    }else if(starWars.isSelectDefender == false){
                        starWars.isSelectDefender = true;
                        starWars.defender_hp = $(this).attr("health_points");
                        $(".defender_hero").append($(this));
                        $(".available_enemies").children().last().css("float","none");
                        $(this).addClass("defender");
                        $(this).css("float","none");
                    }
                });

                $("#fight").click(function(){
                    var hero = $(".selected_hero");
                    var defender = $(".defender");
                    if(!starWars.game_over){
                        starWars.defender_hp = parseInt(starWars.defender_hp) - parseInt(hero.attr("attack_power"));
                        starWars.hero_hp = parseInt(starWars.hero_hp) - parseInt(defender.attr("counter_attack_power"));
                        starWars.updateGame();
                    }else{
                        alert("Game Over");
                    }
                    
                })
            },
            updateGame:function(){
                $(".defender .hp").text(this.defender_hp);
                $(".selected_hero .hp").text(this.hero_hp);
                var hero_attack_power = 0;
                if(starWars.hero_hp <= 0){
                    // end game. Hero died.
                    starWars.game_over = true;
                    console.log("game over");
                }else{
                    //hero still alive, power up!
                    hero_attack_power = parseInt($(".selected_hero").attr("attack_power")) * 2;
                    $(".selected_hero").attr("attack_power",hero_attack_power);
                }
                
                if(starWars.defender_hp <=0 && !starWars.game_over){
                    // defender died. 
                    $(".defender").remove();
                    starWars.isSelectDefender = false;
                }

            }
            
        }
        
        starWars.initiateGame();
        

    </script>
</body>
</html>